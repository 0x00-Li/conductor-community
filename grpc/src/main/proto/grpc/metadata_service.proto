syntax = "proto3";
package conductor.grpc;

import "google/protobuf/empty.proto";
import "model/taskdef.proto";
import "model/workflowdef.proto";

option java_package = "com.netflix.conductor.grpc";
option java_outer_classname = "MetadataServicePb";
option go_package = "github.com/netflix/conductor/client/gogrpc/conductor/grpc";

service MetadataService {
    // POST /workflow
    rpc CreateWorkflow(conductor.proto.WorkflowDef) returns (google.protobuf.Empty);

    // PUT /workflow
    rpc UpdateWorkflows(UpdateWorkflowsRequest) returns (google.protobuf.Empty);

    // GET /workflow/{name}
    rpc GetWorkflow(GetWorkflowRequest) returns (conductor.proto.WorkflowDef);

    // GET /workflow
    rpc GetAllWorkflows(google.protobuf.Empty) returns (stream conductor.proto.WorkflowDef);

    // POST /taskdefs
    rpc CreateTasks(CreateTasksRequest) returns (google.protobuf.Empty);

    // PUT /taskdefs
    rpc UpdateTask(conductor.proto.TaskDef) returns (google.protobuf.Empty);

    // GET /taskdefs/{tasktype}
    rpc GetTask(GetTaskRequest) returns (conductor.proto.TaskDef);

    // GET /taskdefs
    rpc GetAllTasks(google.protobuf.Empty) returns (stream conductor.proto.TaskDef);

    // DELETE /taskdefs/{tasktype}
    rpc DeleteTask(GetTaskRequest) returns (google.protobuf.Empty);
}

message UpdateWorkflowsRequest {
    repeated conductor.proto.WorkflowDef defs = 1;
}

message CreateTasksRequest {
    repeated conductor.proto.TaskDef defs = 1;
}

message GetWorkflowRequest {
    string name = 1;
    int32 version = 2;
}

message GetTaskRequest {
    string task_type = 1;
}
